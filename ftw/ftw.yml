---

logfile: '/build/ftw.log'
maxmarkerretries: 10
testoverride:
  input:
    dest_addr: 'haproxy'
    port: 8080
  ignore:
    # Imported from https://github.com/corazawaf/coraza/blob/main/testing/coreruleset/.ftw.yml
    920100-4: 'Invalid uri, Coraza not reached - 404 page not found' 

    # Failing tests related to upstream issues:
    921250-1: 'Expected to match $Version in cookies, failing also in upstream'
    921250-2: 'Expected to match $Version in cookies, failing also in upstream'
    933120-2: 'To be investigated: match_regex value  might be ModSec specific'

    # HAProxy specific.
    920270-4: 'Rule works, log contains 920270. Test expects status 400 (Apache behaviour)'
    920290-1: 'Rule works, log contains 920290. Test expects status 400 (Apache behaviour)'
    920430-5: 'Test has expect_error, Go/http, Envoy and HAProxy return 400'
    920620-1: 'Rule works, log contains 920620. Test expects 200 (Apache behavour)'
    920430-8: 'Unknown HTTP Versions are blocked in HAProxy'
    920400-1: 'Limited Body content length because of protocol limitations.'

    # TODO investigate failing tests:
    922130-1:  ''
    922130-2:  ''
    922130-7:  ''
    942521-17: ''
    "920100-10": ''
    "920100-14": ''
    "920100-16": ''
    "920180-1": ''
    "920180-3": ''
    "920190-2": ''
    "920190-3": ''
    "920200-1": ''
    "920200-2": ''
    "920200-4": ''
    "920200-5": ''
    "920200-6": ''
    "920200-8": ''
    "920201-1": ''
    "920201-2": ''
    "920202-1": ''
    "920202-2": ''
    "920210-2": ''
    "920210-3": ''
    "920210-4": ''
    "920210-6": ''
    "920210-7": ''
    "920230-1": ''
    "920240-1": ''
    "920240-5": ''
    "920240-6": ''
    "920250-1": ''
    "920250-2": ''
    "920250-3": ''
    "920250-4": ''
    "920260-1": ''
    "920260-3": ''
    "920274-1": ''
    "920280-1": ''
    "920300-1": ''
    "920310-1": ''
    "920310-4": ''
    "920311-1": ''
    "920320-1": ''
    "920330-1": ''
    "920340-1": ''
    "920340-2": ''
    "920350-1": ''
    "920350-3": ''
    "920350-4": ''
    "920350-5": ''
    "920350-6": ''
    "920390-1": ''
    "920410-1": ''
    "934120-23": ''
    "934120-24": ''
    "934120-25": ''
    "934120-26": ''
    "934120-39": ''
    "942420-1": ''
    "942421-1": ''
    "942430-1": ''
    "942431-1": ''
    "942432-1": ''
    "942460-1": ''